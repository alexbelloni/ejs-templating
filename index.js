import fetch from 'node-fetch';
import ejs from 'ejs';
import fs from 'fs';

// people from the database 
const peopleResponse = await fetch('https://randomuser.me/api/?nat=ca&results=3')
const people = await peopleResponse.json();

// const people = {results: [{"gender":"male","name":{"title":"Mr","first":"Samuel","last":"Campbell"},"location":{"street":{"number":6930,"name":"Duke St"},"city":"Victoria","state":"Yukon","country":"Canada","postcode":"T9X 4R3","coordinates":{"latitude":"-6.4423","longitude":"-25.8585"},"timezone":{"offset":"+10:00","description":"Eastern Australia, Guam, Vladivostok"}},"email":"samuel.campbell@example.com","login":{"uuid":"d2eb6ef0-fdde-4fea-a75a-db47c1a827aa","username":"greenmouse871","password":"jetski","salt":"9Z1486QP","md5":"3e382b7e092947132a5a1475c0cb7258","sha1":"bfc07dcb505847452caca05818deab4937569d04","sha256":"898778fdb372632ba61d7ccf70f1633d7644658eeff9541188a628be8b7b9f7c"},"dob":{"date":"1984-09-14T12:59:07.286Z","age":37},"registered":{"date":"2006-12-05T02:50:15.796Z","age":15},"phone":"706-514-6645","cell":"876-304-1901","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/men/47.jpg","medium":"https://randomuser.me/api/portraits/med/men/47.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/47.jpg"},"nat":"CA"},{"gender":"male","name":{"title":"Mr","first":"Hudson","last":"Ambrose"},"location":{"street":{"number":1918,"name":"West Ave"},"city":"Woodstock","state":"Nunavut","country":"Canada","postcode":"V9R 7N2","coordinates":{"latitude":"-11.9325","longitude":"33.0863"},"timezone":{"offset":"+9:00","description":"Tokyo, Seoul, Osaka, Sapporo, Yakutsk"}},"email":"hudson.ambrose@example.com","login":{"uuid":"dba6171f-02bf-4e6a-9e26-0e3ff8c66692","username":"silverladybug629","password":"ytrewq","salt":"AyyJjbHv","md5":"fdbd68946f722d4f8d3c0a484099216c","sha1":"53765c4184e7cfdae1302c79c086b04cdc7590d5","sha256":"0bf50c97470e5c3326fc83863eb22da5f06eb9e0c6c0dc9dcf67d09611648a93"},"dob":{"date":"1975-01-06T08:28:14.975Z","age":46},"registered":{"date":"2015-12-02T21:20:00.831Z","age":6},"phone":"614-820-9790","cell":"165-493-2603","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/men/27.jpg","medium":"https://randomuser.me/api/portraits/med/men/27.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/27.jpg"},"nat":"CA"},{"gender":"female","name":{"title":"Ms","first":"Megan","last":"Ma"},"location":{"street":{"number":5423,"name":"Disputed Rd"},"city":"Burlington","state":"Saskatchewan","country":"Canada","postcode":"U5Z 8B2","coordinates":{"latitude":"-85.8270","longitude":"16.3884"},"timezone":{"offset":"+11:00","description":"Magadan, Solomon Islands, New Caledonia"}},"email":"megan.ma@example.com","login":{"uuid":"5fc798c4-a27e-430e-be03-a87e63914deb","username":"beautifulgoose976","password":"millions","salt":"zDCziuZ9","md5":"fa6f1fcdeeced43f3da210c5ffd882bc","sha1":"2421aafb0bbf56bfd27fee1690ace05c7609f112","sha256":"b2eb29aab30c8c27b210ff603595d24f81a913c7f4c603f2ebcd90242a08d526"},"dob":{"date":"1986-02-22T23:36:18.093Z","age":35},"registered":{"date":"2009-01-06T07:56:27.841Z","age":12},"phone":"465-778-9566","cell":"785-911-9177","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/women/13.jpg","medium":"https://randomuser.me/api/portraits/med/women/13.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/13.jpg"},"nat":"CA"}]}

ejs.renderFile(`./views/index.ejs`, { people: people.results }, {}, function (err, str) {
    fs.writeFile('./report.html', err || str, ()=>{});
});

